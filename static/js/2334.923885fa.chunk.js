"use strict";(self.webpackChunkclass_interactives=self.webpackChunkclass_interactives||[]).push([[2334],{2334:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var r=s(2791),n=s(6710),o=s.n(n);const a="AudioWordComplete_audioWordCompleteContainer__HYZRY",c="AudioWordComplete_audioPlayer__5VfU9",l="AudioWordComplete_sentence__U-0yV",u="AudioWordComplete_inputBox__2gpj3",i="AudioWordComplete_foundWord__TCqCY",d="AudioWordComplete_wrong__KtE0s",p="AudioWordComplete_nextQuestion__ciWpJ",m="AudioWordComplete_celebration__koUjh";var h=s(6187),f=s(184);const g=function(e){let{text:t}=e;const[s,n]=(0,r.useState)([]),[g,_]=(0,r.useState)(0),[C,x]=(0,r.useState)(!1),[w,y]=(0,r.useState)(""),[j,T]=(0,r.useState)(null),[v,E]=(0,r.useState)([]),[L,W]=(0,r.useState)({}),[b,k]=(0,r.useState)(!1),[S,A]=(0,r.useState)(!1),N=(0,r.useRef)(null),R=(0,r.useRef)(null),U=(0,r.useRef)({}),{imageData:V}=(0,h.c)();(0,r.useEffect)((()=>{(()=>{const e=t.trim().split(/\r?\n\s*\r?\n/).map(((e,t)=>{const s=e.split(/\r?\n/).map((e=>e.trim()));if(4!==s.length)return console.error("Block ".concat(t+1,": Expected 4 lines but got ").concat(s.length,".")),null;const[r,n,o,a]=s;return{url:r,startTime:parseFloat(n),endTime:parseFloat(o),sentence:a}})).filter((e=>null!==e));n(e)})()}),[t]),(0,r.useEffect)((()=>{if(s.length>0&&g<s.length){const e=s[g];T(e),y(e.sentence);const t=/\*([^\s]+)/g,r=[];let n;for(;null!==(n=t.exec(e.sentence));){let e=n[1];e=e.replace(/[.,?!]+$/,""),r.push(e)}E(r);const o={};r.forEach((e=>{o[e]=""})),W(o),k(!1),A(!0)}else g>=s.length&&s.length>0&&x(!0)}),[s,g]),(0,r.useEffect)((()=>{j&&(S?"[local]"===j.url?R.current&&(R.current.currentTime=j.startTime,R.current.play().catch((e=>{console.error("Error playing audio:",e)}))):N.current&&N.current.seekTo(j.startTime,"seconds"):"[local]"===j.url&&R.current&&R.current.pause())}),[j,S]),(0,r.useEffect)((()=>{const e=v.every((e=>L[e].trim().toLowerCase()===e.toLowerCase()));if(k(e),!e){const e=v.find((e=>L[e].trim().toLowerCase()!==e.toLowerCase()));e&&U.current[e]&&U.current[e].focus()}}),[L,v]);const Y=e=>{const t=e.target.dataset.word,s=e.target.value;W((e=>({...e,[t]:s})))},B=e=>{if("Enter"===e.key){const t=e.target.dataset.word,s=L[t];s.trim().toLowerCase()===t.toLowerCase()?W((e=>({...e,[t]:s}))):(e.target.classList.add(d),setTimeout((()=>{e.target.classList.remove(d)}),500))}};return C?(0,f.jsx)("div",{className:m,children:(0,f.jsx)("span",{role:"img","aria-label":"celebrate",children:"\ud83c\udf89"})}):j?(0,f.jsxs)("div",{className:a,children:[(0,f.jsx)("div",{className:c,children:(0,f.jsx)("button",{onClick:()=>{A(!1),setTimeout((()=>{A(!0)}),100)},children:"Repeat Audio"})}),"[local]"===j.url?(0,f.jsx)("audio",{ref:R,src:V?URL.createObjectURL(V):"",onTimeUpdate:()=>{if(R.current){R.current.currentTime>=j.endTime&&(R.current.pause(),A(!1))}},onEnded:()=>{A(!1)},style:{display:"none"}}):(0,f.jsx)(o(),{ref:N,url:j.url,playing:S,controls:!1,width:"0",height:"0",onProgress:e=>{e.playedSeconds>=j.endTime&&A(!1)},onEnded:()=>A(!1),config:{youtube:{playerVars:{autoplay:1,controls:0,start:j.startTime,end:j.endTime}}}}),(0,f.jsx)("div",{className:l,children:(()=>{U.current={};const e=[];let t=w;t=t.replace(/\*/g,"");return t.split(/(\s+)/).forEach(((t,s)=>{const r=t.trim().match(/^([^\s.,?!]+)([.,?!]*)$/);if(r){const[n,o,a]=r;if(v.includes(o)){const t=L[o]||"";t.trim().toLowerCase()===o.toLowerCase()?e.push((0,f.jsx)("span",{className:i,style:{minWidth:"".concat(o.length,"ch")},children:o},s)):e.push((0,f.jsx)("input",{ref:e=>{e&&(U.current[o]=e)},type:"text","data-word":o,value:t,onChange:Y,onKeyDown:B,style:{width:"".concat(o.length,"ch")},className:u},s)),e.push(a)}else e.push(t)}else e.push(t)})),e})()}),b&&(0,f.jsx)("div",{className:p,children:(0,f.jsx)("button",{onClick:()=>{_((e=>e+1)),A(!0)},children:"Next Question"})})]}):null}}}]);
//# sourceMappingURL=2334.923885fa.chunk.js.map