"use strict";(self.webpackChunkmy_react_app=self.webpackChunkmy_react_app||[]).push([[69],{1069:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var a=n(2791),i=n(5851),l=n(6187);const s={instructions:"ImagePins_instructions__w8Bvv",imagePinMaincontainer:"ImagePins_imagePinMaincontainer__ve+Rp",imagePinContainer:"ImagePins_imagePinContainer__gV26t",imagePinImage:"ImagePins_imagePinImage__IpjTM",pinLabel:"ImagePins_pinLabel__boY-Q",imagePinInstruction:"ImagePins_imagePinInstruction__yX44S",pin:"ImagePins_pin__FcmAN"};var r=n(184);const c="[local]";const o=function(e){let{text:t}=e;const[n,o]=(0,a.useState)([]),[u,p]=(0,a.useState)(!0),[g,d]=(0,a.useState)({type:null,index:null,startX:0,startY:0}),[m,h]=(0,a.useState)(null),[f,b]=(0,a.useState)({width:0,height:0}),{textData:x,setTextData:_}=(0,l.c)(),y=(0,a.useRef)(null);(0,a.useEffect)((()=>{const e=t.split("\n"),n=e.pop();if(e.length>0){const t=e.map(((e,t)=>{const n=50+70*Math.floor(t/5),a=50+t%5*70;return{x:n,y:a,label:e,labelX:n,labelY:a-40}}));o(t)}h(n&&!n.includes(c)?n:x)}),[t,x]),(0,a.useEffect)((()=>{const e=setTimeout((()=>{y.current&&(b({width:y.current.offsetWidth,height:y.current.offsetHeight}),o((e=>e.map((e=>e.x>y.current.offsetWidth||e.y>y.current.offsetHeight?{...e,x:100,y:100,labelX:100,labelY:50}:e)))))}),1e3);return()=>clearTimeout(e)}),[m]),(0,a.useEffect)((()=>{const e=setTimeout((()=>{p(!1)}),1e3);return()=>clearTimeout(e)}),[]),(0,a.useEffect)((()=>{const e=()=>{if(!y.current||0===f.width||0===f.height)return;const e=y.current.offsetWidth/f.width,t=y.current.offsetHeight/f.height;let a=n.map((n=>({...n,x:n.x*e,y:n.y*t,labelX:n.labelX*e,labelY:n.labelY*t})));a=a.map((e=>e.x>y.current.offsetWidth||e.y>y.current.offsetHeight?{...e,x:100,y:100,labelX:100,labelY:50}:e)),o(a),y.current&&b({width:y.current.offsetWidth,height:y.current.offsetHeight})};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[f,n]);const P=(e,t,a)=>{e.dataTransfer.setData("text/plain","");const i=n[t],l="pin"===a?i.x:i.labelX,s="pin"===a?i.y:i.labelY;d({type:a,index:t,startX:l,startY:s})},v=e=>{_(e),h(e)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"instructions ".concat(s.instructions),children:"click to drop pins, right-click to delete pin, double-click to add a label; drag labels to reposition."}),(0,r.jsxs)("div",{className:s.imagePinMaincontainer,children:[(0,r.jsxs)("div",{className:s.imagePinContainer,draggable:"false",onDragOver:e=>{e.preventDefault()},onDrop:e=>{if(!y.current||null===g.index)return;const t=y.current.getBoundingClientRect();let a=e.clientX-t.left,i=e.clientY-t.top;const l=a-g.startX,s=i-g.startY;o(n.map(((e,t)=>t===g.index?{...e,x:e.x+("pin"===g.type?l:0),y:e.y+("pin"===g.type?s:0),labelX:e.labelX+l,labelY:e.labelY+s}:e))),d({type:null,index:null,startX:0,startY:0})},children:[(!t.includes(c)||x)&&(0,r.jsx)("img",{ref:y,className:s.imagePinImage,alt:"Highlight",onClick:e=>{if(!y.current)return;const t=y.current.getBoundingClientRect();let n=e.clientX-t.left,a=e.clientY-t.top;o((e=>[...e,{x:Math.max(0,Math.min(n,t.width-20)),y:Math.max(0,Math.min(a,t.height-20)),label:"",labelX:n,labelY:a-40}]))},draggable:"false",src:m,crossOrigin:"anonymous"}),t.includes(c)&&!x&&(0,r.jsxs)("div",{children:["The local image will need to be provided...",(0,r.jsx)("br",{})," ",(0,r.jsx)("input",{type:"file",className:s.fileUpload,accept:"image/*",onChange:e=>(0,i.vh)(e.target.files[0],v)})]}),n.map(((e,t)=>(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)("div",{className:s.pin,style:{left:"".concat(e.x-10,"px"),top:"".concat(e.y-10,"px")},draggable:"true",onDragStart:e=>P(e,t,"pin"),onContextMenu:e=>((e,t)=>{e.preventDefault(),o((e=>e.filter(((e,n)=>n!==t))))})(e,t),onDoubleClick:()=>(e=>{const t=prompt("Enter a label for this pin:",n[e].label);null!==t&&o(n.map(((n,a)=>a===e?{...n,label:t}:n)))})(t)},"pin-".concat(t)),e.label&&(0,r.jsx)("div",{className:s.pinLabel,style:{left:"".concat(e.labelX,"px"),top:"".concat(e.labelY-10,"px")},draggable:"true",onDragStart:e=>P(e,t,"label"),children:e.label})]},"pinlabel-".concat(t))))]}),u&&(0,r.jsxs)("div",{className:s.imagePinInstruction,children:[(0,r.jsx)("h1",{children:"Image Pins"}),(0,r.jsx)("p",{children:"click to drop pins, right-click to delete pin, double-click to add a label; drag labels to reposition."})]})]})]})}}}]);
//# sourceMappingURL=69.1b7443db.chunk.js.map