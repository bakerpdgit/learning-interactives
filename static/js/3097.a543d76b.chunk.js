"use strict";(self.webpackChunkclass_interactives=self.webpackChunkclass_interactives||[]).push([[3097],{3097:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(2791),i=n(5249);const l="Fishbone_container__+3uqx",a="Fishbone_canvas__axqcP",o="Fishbone_controls__DnZY5",c="Fishbone_canvasWrapper__YHU-l",r="Fishbone_headTitle__8SVee",h="Fishbone_branchTitleTop__DpCz2",d="Fishbone_branchTitleBottom__gMR7w",b="Fishbone_branchButtonsUp__+iBJL",u="Fishbone_branchButtonsDown__Bwomp",_="Fishbone_labelUp__G1aSr",f="Fishbone_labelDown__V0LwU",m="Fishbone_labelLine__5xMfX",x="Fishbone_addLabel__wufv+",p="Fishbone_shiftLabel__khX5b";var v=n(184);const w=function(e){let{text:t}=e;const n=(0,s.useRef)(null),w=(0,s.useRef)(null),[S,k]=(0,s.useState)({}),[j,F]=(0,s.useState)({x:0,w:0}),[C,g]=(0,s.useState)([]),[T,M]=(0,s.useState)(1),[N,X]=(0,s.useState)(160),[Y,y]=(0,s.useState)({show:!1,title:"",callback:null}),z=t.split("\n")[0],D=(0,s.useCallback)((()=>{window.setTimeout((()=>{const e=w.current;if(!e)return;const t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);const n=e.height/2,s=Math.max(300,e.width/4),i=e.width-s-10;t.lineWidth=4,t.strokeStyle="black",t.beginPath(),t.moveTo(10,n),t.lineTo(i,n),t.stroke();const l=N,a=.5*e.height,o=a*Math.SQRT1_2,c=a*Math.SQRT1_2,r={};t.lineWidth=2,C.forEach(((e,s)=>{const a=Math.floor(s/2),h=i-(a+1)*l,d=n,b=h-o,u=d+("top"===(s%2===0?"top":"bottom")?-c:c);t.beginPath(),t.moveTo(h,d),t.lineTo(b,u),t.stroke(),r[e.id]={startX:h,startY:d,endX:b,endY:u,midX:(h+b)/2,midY:(d+u)/2}})),k(r),F({x:i,w:s})}),0)}),[C,N,w,k,F]);(0,s.useEffect)((()=>{const e=w.current,t=()=>{n.current&&e&&(e.width=e.offsetWidth,e.height=e.offsetHeight,D())};t();const s=setTimeout(t,50);return window.addEventListener("resize",t),()=>{clearTimeout(s),window.removeEventListener("resize",t)}}),[D]);const L=(e,t)=>{y({show:!0,title:e,callback:t})},B=T+.2,R=T+.1;return(0,v.jsxs)("div",{ref:n,className:l,children:[Y.show&&(0,v.jsx)(i.Z,{title:Y.title,value:"",onSubmit:Y.callback,onClose:()=>y({show:!1})}),(0,v.jsxs)("div",{className:o,children:[(0,v.jsx)("button",{onClick:()=>{L("Branch title",(e=>{e.trim()&&g((t=>[...t,{id:Date.now(),title:e,labels:[],labelShift:0}]))}))},children:"Add Branch"}),(0,v.jsx)("button",{onClick:()=>X((e=>e+20)),children:"Space \u2191"}),(0,v.jsx)("button",{onClick:()=>X((e=>Math.max(40,e-20))),children:"Space \u2193"}),(0,v.jsx)("button",{onClick:()=>M((e=>e+.1)),children:"Font \u2191"}),(0,v.jsx)("button",{onClick:()=>M((e=>Math.max(.5,e-.1))),children:"Font \u2193"})]}),(0,v.jsxs)("div",{className:c,children:[(0,v.jsx)("canvas",{ref:w,className:a}),j.w>0&&(0,v.jsx)("div",{className:r,style:{fontSize:"".concat(B,"em"),left:j.x,width:j.w},children:z}),C.map(((e,t)=>{const n=S[e.id];if(!n)return null;const i=t%2===0?"top":"bottom",l=e.labels||[],a=w.current?.45*w.current.offsetHeight:100;return(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("div",{className:t%2===0?h:d,style:{left:n.endX,top:n.endY,fontSize:"".concat(R,"em")},onContextMenu:t=>{var n;t.preventDefault(),n=e.id,g((e=>e.filter((e=>e.id!==n))))},children:e.title}),(0,v.jsxs)("div",{className:t%2===0?b:u,style:{position:"absolute",left:n.endX,top:n.endY,display:"flex",gap:"5px"},children:[(0,v.jsx)("div",{className:x,style:{fontSize:"".concat(R,"em"),cursor:"pointer"},onClick:()=>{return t=e.id,void L("Label",(e=>{e.trim()&&g((n=>n.map((n=>n.id===t?{...n,labels:[...n.labels,{id:Date.now(),text:e}]}:n))))}));var t},children:"+"}),(0,v.jsx)("div",{className:p,style:{fontSize:"".concat(R,"em"),cursor:"pointer"},onClick:()=>{return t=e.id,void g((e=>e.map((e=>e.id===t?{...e,labelShift:e.labelShift+20}:e))));var t},children:"bottom"===i?"\u2193":"\u2191"})]}),l.map(((t,s)=>{const i=(s+1)/(l.length+1),o=e.labelShift||0;let c=i+(a>0?(o%a+a)%a/a:0);c-=Math.floor(c);const r=n.startX+(n.endX-n.startX)*c,h=n.startY+(n.endY-n.startY)*c;return(0,v.jsxs)("div",{className:s%2===0?_:f,style:{left:r,top:h,fontSize:"".concat(T,"em")},onContextMenu:n=>{var s,i;n.preventDefault(),s=e.id,i=t.id,g((e=>e.map((e=>e.id===s?{...e,labels:e.labels.filter((e=>e.id!==i))}:e))))},children:[t.text,(0,v.jsx)("div",{className:m,style:{left:-20,top:"50%",width:20}})]},t.id)}))]},e.id)}))]})]})}}}]);
//# sourceMappingURL=3097.a543d76b.chunk.js.map