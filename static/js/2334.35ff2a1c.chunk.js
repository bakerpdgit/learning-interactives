"use strict";(self.webpackChunkclass_interactives=self.webpackChunkclass_interactives||[]).push([[2334],{2334:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var r=s(2791),n=s(6710),o=s.n(n);const a="AudioWordComplete_audioWordCompleteContainer__lxOd9",l="AudioWordComplete_audioPlayer__Xs7K+",c="AudioWordComplete_sentence__T9oNz",u="AudioWordComplete_inputBox__Y+bp7",i="AudioWordComplete_foundWord__3yHiO",d="AudioWordComplete_wrong__oe2oB",p="AudioWordComplete_nextQuestion__xPfx3",m="AudioWordComplete_celebration__Q5sEk";var h=s(6187),f=s(184);const _=function(e){let{text:t}=e;const[s,n]=(0,r.useState)([]),[_,g]=(0,r.useState)(0),[C,x]=(0,r.useState)(!1),[w,y]=(0,r.useState)(""),[T,j]=(0,r.useState)(null),[v,E]=(0,r.useState)([]),[L,b]=(0,r.useState)({}),[W,k]=(0,r.useState)(!1),[S,A]=(0,r.useState)(!1),N=(0,r.useRef)(null),R=(0,r.useRef)(null),B=(0,r.useRef)({}),{imageData:O}=(0,h.c)();(0,r.useEffect)((()=>{(()=>{const e=t.trim().split(/\r?\n\s*\r?\n/).map(((e,t)=>{const s=e.split(/\r?\n/).map((e=>e.trim()));if(4!==s.length)return console.error("Block ".concat(t+1,": Expected 4 lines but got ").concat(s.length,".")),null;const[r,n,o,a]=s;return{url:r,startTime:parseFloat(n),endTime:parseFloat(o),sentence:a}})).filter((e=>null!==e));n(e)})()}),[t]),(0,r.useEffect)((()=>{if(s.length>0&&_<s.length){const e=s[_];j(e),y(e.sentence);const t=/\*([^\s]+)/g,r=[];let n;for(;null!==(n=t.exec(e.sentence));){let e=n[1];e=e.replace(/[.,?!]+$/,""),r.push(e)}E(r);const o={};r.forEach((e=>{o[e]=""})),b(o),k(!1),A(!0)}else _>=s.length&&s.length>0&&x(!0)}),[s,_]),(0,r.useEffect)((()=>{T&&(S?"[local]"===T.url?R.current&&(R.current.currentTime=T.startTime,R.current.play().catch((e=>{console.error("Error playing audio:",e)}))):N.current&&N.current.seekTo(T.startTime,"seconds"):"[local]"===T.url&&R.current&&R.current.pause())}),[T,S]),(0,r.useEffect)((()=>{const e=v.every((e=>L[e].trim().toLowerCase()===e.toLowerCase()));if(k(e),!e){const e=v.find((e=>L[e].trim().toLowerCase()!==e.toLowerCase()));e&&B.current[e]&&B.current[e].focus()}}),[L,v]);const P=e=>{const t=e.target.dataset.word,s=e.target.value;b((e=>({...e,[t]:s})))},Q=e=>{if("Enter"===e.key){const t=e.target.dataset.word,s=L[t];s.trim().toLowerCase()===t.toLowerCase()?b((e=>({...e,[t]:s}))):(e.target.classList.add(d),setTimeout((()=>{e.target.classList.remove(d)}),500))}};return C?(0,f.jsx)("div",{className:m,children:(0,f.jsx)("span",{role:"img","aria-label":"celebrate",children:"\ud83c\udf89"})}):T?(0,f.jsxs)("div",{className:a,children:[(0,f.jsx)("div",{className:l,children:(0,f.jsx)("button",{onClick:()=>{A(!1),setTimeout((()=>{A(!0)}),100)},children:"Repeat Audio"})}),"[local]"===T.url?(0,f.jsx)("audio",{ref:R,src:O?URL.createObjectURL(O):"",onTimeUpdate:()=>{if(R.current){R.current.currentTime>=T.endTime&&(R.current.pause(),A(!1))}},onEnded:()=>{A(!1)},style:{display:"none"}}):(0,f.jsx)(o(),{ref:N,url:T.url,playing:S,controls:!1,width:"0",height:"0",onProgress:e=>{e.playedSeconds>=T.endTime&&A(!1)},onEnded:()=>A(!1),config:{youtube:{playerVars:{autoplay:1,controls:0,start:T.startTime,end:T.endTime}}}}),(0,f.jsx)("div",{className:c,children:(()=>{B.current={};const e=[];let t=w;t=t.replace(/\*/g,"");return t.split(/(\s+)/).forEach(((t,s)=>{const r=t.trim().match(/^([^\s.,?!]+)([.,?!]*)$/);if(r){const[n,o,a]=r;if(v.includes(o)){const t=L[o]||"";t.trim().toLowerCase()===o.toLowerCase()?e.push((0,f.jsx)("span",{className:i,style:{minWidth:"".concat(o.length,"ch")},children:o},s)):e.push((0,f.jsx)("input",{ref:e=>{e&&(B.current[o]=e)},type:"text","data-word":o,value:t,onChange:P,onKeyDown:Q,style:{width:"".concat(o.length,"ch")},className:u},s)),e.push(a)}else e.push(t)}else e.push(t)})),e})()}),W&&(0,f.jsx)("div",{className:p,children:(0,f.jsx)("button",{onClick:()=>{g((e=>e+1)),A(!0)},children:"Next Question"})})]}):null}}}]);
//# sourceMappingURL=2334.35ff2a1c.chunk.js.map