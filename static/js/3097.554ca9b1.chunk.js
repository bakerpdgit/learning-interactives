"use strict";(self.webpackChunkclass_interactives=self.webpackChunkclass_interactives||[]).push([[3097],{3097:(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var s=n(2791),i=n(5249);const l="Fishbone_container__wVv0B",a="Fishbone_canvas__NtPIH",o="Fishbone_controls__xQrzF",c="Fishbone_canvasWrapper__Um0W6",r="Fishbone_headTitle__6Z42k",h="Fishbone_branchTitleTop__We1uv",d="Fishbone_branchTitleBottom__WNk8Y",b="Fishbone_branchButtonsUp__2urmZ",u="Fishbone_branchButtonsDown__gvxwy",_="Fishbone_labelUp__xla2a",m="Fishbone_labelDown__VB2qa",f="Fishbone_labelLine__QbdcL",p="Fishbone_addLabel__VcABt",x="Fishbone_shiftLabel__Vq5pj";var v=n(184);const w=function(t){let{text:e}=t;const n=(0,s.useRef)(null),w=(0,s.useRef)(null),[S,k]=(0,s.useState)({}),[j,F]=(0,s.useState)({x:0,w:0}),[g,C]=(0,s.useState)((()=>e.split("\n").slice(1).filter((t=>""!==t.trim())).map(((t,e)=>({id:Date.now()+e,title:t.trim(),labels:[],labelShift:0}))))),[T,N]=(0,s.useState)(1),[y,M]=(0,s.useState)(160),[Y,z]=(0,s.useState)({show:!1,title:"",callback:null}),B=e.split("\n")[0],X=(0,s.useCallback)((()=>{window.setTimeout((()=>{const t=w.current;if(!t)return;const e=t.getContext("2d");e.clearRect(0,0,t.width,t.height);const n=t.height/2,s=Math.max(300,t.width/6),i=t.width-s-10;e.lineWidth=4,e.strokeStyle="black",e.beginPath(),e.moveTo(10,n),e.lineTo(i,n),e.stroke();const l=y,a=.45*t.height,o=a*Math.SQRT1_2,c=a*Math.SQRT1_2,r={};e.lineWidth=2,g.forEach(((t,s)=>{const a=Math.floor(s/2),h=i-(a+1)*l,d=n,b=h-o,u=d+("top"===(s%2===0?"top":"bottom")?-c:c);e.beginPath(),e.moveTo(h,d),e.lineTo(b,u),e.stroke(),r[t.id]={startX:h,startY:d,endX:b,endY:u,midX:(h+b)/2,midY:(d+u)/2}})),k(r),F({x:i,w:s})}),0)}),[g,y,w,k,F]);(0,s.useEffect)((()=>{const t=w.current,e=()=>{n.current&&t&&(t.width=t.offsetWidth,t.height=t.offsetHeight,X())};e();const s=setTimeout(e,50);return window.addEventListener("resize",e),()=>{clearTimeout(s),window.removeEventListener("resize",e)}}),[X]);const D=(t,e)=>{z({show:!0,title:t,callback:e})},L=T+.2,W=T+.1;return(0,v.jsxs)("div",{ref:n,className:l,children:[Y.show&&(0,v.jsx)(i.Z,{title:Y.title,value:"",onSubmit:Y.callback,onClose:()=>z({show:!1})}),(0,v.jsxs)("div",{className:o,children:[(0,v.jsx)("button",{onClick:()=>{D("Branch title",(t=>{t.trim()&&C((e=>[...e,{id:Date.now(),title:t,labels:[],labelShift:0}]))}))},children:"Add Branch"}),(0,v.jsx)("button",{onClick:()=>M((t=>t+20)),children:"Space \u2191"}),(0,v.jsx)("button",{onClick:()=>M((t=>Math.max(40,t-20))),children:"Space \u2193"}),(0,v.jsx)("button",{onClick:()=>N((t=>t+.1)),children:"Font \u2191"}),(0,v.jsx)("button",{onClick:()=>N((t=>Math.max(.5,t-.1))),children:"Font \u2193"})]}),(0,v.jsxs)("div",{className:c,children:[(0,v.jsx)("canvas",{ref:w,className:a}),j.w>0&&(0,v.jsx)("div",{className:r,style:{fontSize:"".concat(L,"em"),left:j.x,width:j.w},children:B}),g.map(((t,e)=>{const n=S[t.id];if(!n)return null;const i=e%2===0?"top":"bottom",l=t.labels||[],a=w.current?.45*w.current.offsetHeight:100;return(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("div",{className:e%2===0?h:d,style:{left:n.endX,top:n.endY,fontSize:"".concat(W,"em")},onContextMenu:e=>{var n;e.preventDefault(),n=t.id,C((t=>t.filter((t=>t.id!==n))))},children:t.title}),(0,v.jsxs)("div",{className:e%2===0?b:u,style:{position:"absolute",left:n.endX,top:n.endY,display:"flex",gap:"5px"},children:[(0,v.jsx)("div",{className:p,style:{fontSize:"".concat(W,"em"),cursor:"pointer"},onClick:()=>{return e=t.id,void D("Label",(t=>{t.trim()&&C((n=>n.map((n=>n.id===e?{...n,labels:[...n.labels,{id:Date.now(),text:t}],labelShift:0}:n))))}));var e},children:"+"}),(0,v.jsx)("div",{className:x,style:{fontSize:"".concat(W,"em"),cursor:"pointer"},onClick:()=>(t=>{const e=w.current.height*Math.SQRT1_2/16;C((n=>n.map((n=>n.id===t?{...n,labelShift:n.labelShift+e}:n))))})(t.id),children:"bottom"===i?"\u2193":"\u2191"})]}),l.map(((e,s)=>{const o=l.length,c=o>0?(s+.5)/o:0,r=t.labelShift||0;let h=c+(a>0?(r%a+a)%a/a:0);h-=Math.floor(h);const d=n.startX+(n.endX-n.startX)*h,b=n.startY+(n.endY-n.startY)*h;return(0,v.jsxs)("div",{className:"top"===i?_:m,style:{left:d,top:b,fontSize:"".concat(T,"em")},onContextMenu:n=>{var s,i;n.preventDefault(),s=t.id,i=e.id,C((t=>t.map((t=>t.id===s?{...t,labels:t.labels.filter((t=>t.id!==i))}:t))))},children:[e.text,(0,v.jsx)("div",{className:f,style:{left:-20,top:"50%",width:20}})]},e.id)}))]},t.id)}))]})]})}}}]);
//# sourceMappingURL=3097.554ca9b1.chunk.js.map